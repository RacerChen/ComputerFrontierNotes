# 并发系统验证

刘关俊 教授

## 嫦娥五号

### 四个首次

首次在月球表面自动采样

首次从月面起飞

首次在38万公里外的月球进行无人自动对接

首次带着月壤以接近第二宇宙速度回国

### 关键

* 关键环节自主控制
* 60%以上的功能涉及软件实现

总设计师：杨孟飞，中国科学院院士

相关机构/公司：502所遇轩宇信息

## 严重事故与重大损失

### 例子1

欧洲阿丽亚娜5型火箭1996年6月4日发射时候爆炸

原因：软件故障，64位浮点数跳到16位，造成处理器困顿（算子错误）。4型火箭水平速率用的16位变量。

### 例子2

宰赫兰导弹事件，因为每工作1小时后，系统内时钟会有毫秒级别的延迟。爱国者反导系统连续工作100小时了，延迟积累1/3秒。

### 例子3

波音737 MAX8事件，程序只相信传感器，把决定权交给机器。

MCAS系统：因为该飞机动力太强，加速时机头会上翘，所以在尾部加向下喷气机制压机头。但出事时传感器故障，导致机头不断下压，最终坠海。

### 例子4

2015年，某犯罪份子利用京东系统漏洞雇人每天刷5000单，骗取金豆套现800万。

## 软件正确性

* 测试（Testing）
  * 测试用例难以覆盖所有情况
  * 安全攸关系统难以在真实场景下测试
* 验证（Verification）
  * 数学模型
    * 定理证明
    * 模型检测（Model checking）

* 数学模型+模型检测（问题）
  * 抽象之后有些信息丢失
  * 抽象哪些东西（事件和时间地点有关等）
  * 验证技术受限（状态爆炸）
  * 自动建模难
  * 对工程人员要求高
* 数学模型
  * 控制流（并发、资源共享、交互）
  * 数据流
  * 事件的时间约束
  * 概率问题

## 并发是计算机科学重要研究之一

### 一

“经典的形式与与自动机理论考虑的是系统的顺序行为”

N. Chomsky（哲学家，语言学家。提出0型文法，上下午无关文法，上下文有关文法，正规文法。文法形成语言。最后与研究自动机的人呼应上了，0型文法对应图灵机，处理能力最强）

缺点：缺少并发行为的考虑。

### 二

“并发理论需要全新的概念框架而不是对自己已有顺序计算的细化”

R. Milner图灵奖获得者。

### 三

L. Lamport

### 四

C.A. Petri提出，数学与计算机科学家。用数学模型刻画并发模型的第一人。Petri Net的奠基人。

原始Prtri Net只能刻画状态，不能刻画数值问题。所以后续有些改进随机、着色、时间等Petri网。

## 并发系统行为正确性

活性（Liveness），死锁，活锁（进程在运行，但实际上已经停止），可达性，公平性，健壮性（Soundness），兼容，数据一致性（Data consistency），线性时序逻辑（LTL），计算树逻辑（CTL）

### 工作流网健壮性判定复杂度

健壮性（Soundness）：既无死锁，也无活锁（弱健壮性）

## 总结

* 安全攸关的系统，模型检测技术值得探究
* 工程人员友好的自动建模与分析
* 有效的分析方法